\ProvidesPackage{thesis}[2007/12/20]
%\RequirePackage{timing}

\RequirePackage{amsmath}
\RequirePackage{cancel}
\RequirePackage{maybemath}
\RequirePackage{braket}
\RequirePackage{xspace}
\RequirePackage{SIunits}
\RequirePackage{hepunits}
\RequirePackage{geometry}
\setmainmatterspacing{onehalf}

\geometry{reset}
\geometry{left=4cm}
\geometry{top=2.5cm}
\geometry{bottom=2.5cm}
\geometry{right=2.5cm}


%% Citation spacing hack to bring the citation
%% number a little closer to the referring text
\let\@OldCite\cite
\renewcommand{\cite}[1]{\mbox{\!\!\!\@OldCite{#1}}}

%% a list of macros
%% all in one so you do not have to open xxxx+ files

%% Maths
\DeclareRobustCommand{\thesismath}[1]{\ensuremath{\maybebmsf{#1}}}
\DeclareRobustCommand{\parenths}[1]{\thesismath{\left({#1}\right)}}
\DeclareRobustCommand{\braces}[1]{\thesismath{\left\{{#1}\right\}}}
\DeclareRobustCommand{\angles}[1]{\thesismath{\left\langle{#1}\right\rangle}}
\DeclareRobustCommand{\sqbracs}[1]{\thesismath{\left[{#1}\right]}}
\DeclareRobustCommand{\mods}[1]{\thesismath{\left\lvert{#1}\right\rvert}}
\DeclareRobustCommand{\modsq}[1]{\thesismath{\mods{#1}^2}}
\DeclareRobustCommand{\dblmods}[1]{\thesismath{\left\lVert{#1}\right\rVert}}
\DeclareRobustCommand{\expOf}[1]{\thesismath{\exp{\!\parenths{#1}}}}
\DeclareRobustCommand{\eexp}[1]{\thesismath{e^{#1}}}
\DeclareRobustCommand{\plusquad}{\thesismath{\oplus}}
\DeclareRobustCommand{\logOf}[1]{\log\!\parenths{#1}}
\DeclareRobustCommand{\lnOf}[1]{\ln\!\parenths{#1}}
\DeclareRobustCommand{\ofOrder}[1]{\thesismath{ \mathcal{O}\parenths{#1} }}

%% General utility defns
\DeclareRobustCommand{\arXivCode}[1]{arXiv:#1}


%C++ macro (to be moved!)
\DeclareRobustCommand{\CC}{C\nolinebreak\hspace{-.05em}\raisebox{.4ex}{\tiny\bf +}\nolinebreak\hspace{-.10em}\raisebox{.4ex}{\tiny\bf +}}
\def\CCtwo{{C\nolinebreak[4]\hspace{-.05em}\raisebox{.4ex}{\tiny\bf ++}}}
\DeclareRobustCommand{\Rplus}{\protect\nolinebreak\hspace{-.07em}\protect\raisebox{.25ex}{\small\textbf{+}}}
\DeclareRobustCommand{\Cpp}{C\Rplus\Rplus\xspace}

% General lagrangian formalism
\DeclareRobustCommand{\matrixelementM}{\thesismath{ \mathcal{M} }\xspace}
\DeclareRobustCommand{\matrixelementA}{\thesismath{ \mathcal{A} }\xspace}

\DeclareRobustCommand{\Amplitude}[1]{\thesismath{
    \mathcal{A}%
    \begingroup%
    \def\@empty{}%
    \def\@arg{#1}%
    \ifx\@arg\@empty{}\else\parenths{#1}\fi%
    \endgroup%
}}

% also want Rate and BranchingRatio
\DeclareRobustCommand{\Lagrangian}{\thesismath{ \mathcal{L} }\xspace}
\DeclareRobustCommand{\Hamiltonian}{\thesismath{ \mathcal{H} }\xspace}
\DeclareRobustCommand{\lagrangian}{\Lagrangian}
\DeclareRobustCommand{\hamiltonian}{\Hamiltonian}

% Rates and measurements
\DeclareRobustCommand{\BR}[1]{\thesismath{%
    \def\empty{}%
    \def\thearg{#1}%
    \mathcal{B}%
    \ifx\thearg\empty{}\else{(\HepProcess{#1})}\fi%
}\xspace}

\DeclareRobustCommand{\efficiency}[1]{\thesismath{
    \def\empty{}%
    \def\thearg{#1}%
    \varepsilon%
    \ifx\thearg\empty{}\else{(\text{#1})}\fi%
}\xspace}





\DeclareRobustCommand{\MathUpright}[1]{\thesismath{\mathrm{#1}}}
\DeclareRobustCommand{\MathText}[1]{\ensuremath{\text{#1}}}
\DeclareRobustCommand{\RHS}{\MathText{right hand side}\xspace}
\DeclareRobustCommand{\LHS}{\MathText{left hand side}\xspace}

%% Groupings
\DeclareRobustCommand{\parenths}[1]{\thesismath{\left({#1}\right)}}
\DeclareRobustCommand{\braces}[1]{\thesismath{\left\{{#1}\right\}}}
\DeclareRobustCommand{\angles}[1]{\thesismath{\left\langle{#1}\right\rangle}}
\DeclareRobustCommand{\sqbracs}[1]{\thesismath{\left[{#1}\right]}}
\DeclareRobustCommand{\mods}[1]{\thesismath{\left\lvert{#1}\right\rvert}}
\DeclareRobustCommand{\modsq}[1]{\thesismath{\mods{#1}^2}}
\DeclareRobustCommand{\dblmods}[1]{\thesismath{\left\lVert{#1}\right\rVert}}
% legacy names
\DeclareRobustCommand{\bigparenths}[1]{\parenths{#1}}
\DeclareRobustCommand{\bigbraces}[1]{\braces{#1}}
\DeclareRobustCommand{\bigangles}[1]{\angles{#1}}
\DeclareRobustCommand{\bigsqbracs}[1]{\sqbracs{#1}}
\DeclareRobustCommand{\bigmods}[1]{\mods{#1}}
\DeclareRobustCommand{\bigmodsq}[1]{\modsq{#1}}
\DeclareRobustCommand{\bigdblmods}[1]{\dblmods{#1}}

%% Misc
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\sign}{sgn}
\DeclareMathOperator{\li}{li}
\DeclareMathOperator{\trace}{Tr}
\DeclareRobustCommand{\expparenths}[1]{\thesismath{\exp{\!\parenths{#1}}}}
\DeclareRobustCommand{\expbraces}[1]{\thesismath{\exp{\!\braces{#1}}}}
\DeclareRobustCommand{\expOf}[1]{\expparenths{#1}} % generalise to have braces specifier 1st arg
\DeclareRobustCommand{\eexp}[1]{\thesismath{e^{#1}}}
\DeclareRobustCommand{\plusquad}{\thesismath{\oplus}}
\DeclareRobustCommand{\logOf}[1]{\log\!\parenths{#1}}
\DeclareRobustCommand{\lnOf}[1]{\ln\!\parenths{#1}}
\DeclareRobustCommand{\liOf}[1]{\li\!\parenths{#1}}
\DeclareRobustCommand{\signOf}[1]{\sign\!\parenths{#1}}
\DeclareRobustCommand{\diagOf}[1]{\diag\!\parenths{#1}}
\DeclareRobustCommand{\traceOf}[1]{\trace\!\parenths{#1}}

%% For use outside math mode
\let\@oldpm\pm
\DeclareRobustCommand{\pm}{\thesismath{\,\@oldpm\,}}
\let\@oldmp\mp
\DeclareRobustCommand{\mp}{\thesismath{\,\@oldmp\,}}
\let\@oldVert\vert
\DeclareRobustCommand{\vert}{\thesismath{\@oldVert\,}}
\let\@oldTo\to
\DeclareRobustCommand{\to}{\thesismath{\,\@oldTo\,}}
\let\@oldsim\sim
\DeclareRobustCommand{\sim}{\thesismath{\,\@oldsim\,}}
\let\@oldimplies\implies
\DeclareRobustCommand{\implies}{\thesismath{\@oldimplies}}
\DeclareRobustCommand{\To}{\thesismath{\@oldimplies}}
\let\@oldtimes\times
\DeclareRobustCommand{\times}{\thesismath{\,\@oldtimes\,}}
\let\@oldbra\bra
\DeclareRobustCommand{\bra}[1]{\thesismath{\@oldbra{#1}}}
\let\@oldket\ket
\DeclareRobustCommand{\ket}[1]{\thesismath{\@oldket{#1}}}
\let\@oldbraket\braket
\DeclareRobustCommand{\braket}[1]{\thesismath{\@oldbraket{#1}}}

%% Re-define Greek letters for use outside math mode, too
\let\@Oldalpha\alpha%
\let\@Oldbeta\beta%
\let\@Oldgamma\gamma%
\let\@Olddelta\delta%
\let\@Oldepsilon\epsilon%
\let\@Oldvarepsilon\varepsilon%
\let\@Oldzeta\zeta%
\let\@Oldeta\eta%
\let\@Oldtheta\theta%
\let\@Oldvartheta\vartheta%
\let\@Oldiota\iota%
\let\@Oldkappa\kappa%
\let\@Oldlambda\lambda%
\let\@Oldmu\mu%
\let\@Oldnu\nu%
\let\@Oldxi\xi%
\let\@Oldpi\pi%
\let\@Oldvarpi\varpi%
\let\@Oldrho\rho%
\let\@Oldvarrho\varrho%
\let\@Oldsigma\sigma%
\let\@Oldvarsigma\varsigma%
\let\@Oldtau\tau%
\let\@Oldupsilon\upsilon%
\let\@Oldphi\phi%
\let\@Oldvarphi\varphi%
\let\@Oldchi\chi%
\let\@Oldpsi\psi%
\let\@Oldomega\omega%
\renewcommand{\alpha}{\thesismath{\@Oldalpha}\xspace}%
\renewcommand{\beta}{\thesismath{\@Oldbeta}\xspace}%
\renewcommand{\gamma}{\thesismath{\@Oldgamma}\xspace}%
\renewcommand{\delta}{\thesismath{\@Olddelta}\xspace}%
\renewcommand{\epsilon}{\thesismath{\@Oldepsilon}\xspace}%
\renewcommand{\varepsilon}{\thesismath{\@Oldvarepsilon}\xspace}%
\renewcommand{\zeta}{\thesismath{\@Oldzeta}\xspace}%
\renewcommand{\eta}{\thesismath{\@Oldeta}\xspace}%
\renewcommand{\theta}{\thesismath{\@Oldtheta}\xspace}%
\renewcommand{\vartheta}{\thesismath{\@Oldvartheta}\xspace}%
\renewcommand{\iota}{\thesismath{\@Oldiota}\xspace}%
\renewcommand{\kappa}{\thesismath{\@Oldkappa}\xspace}%
\renewcommand{\lambda}{\thesismath{\@Oldlambda}\xspace}%
\renewcommand{\mu}{\thesismath{\@Oldmu}\xspace}%
\renewcommand{\nu}{\thesismath{\@Oldnu}\xspace}%
\renewcommand{\xi}{\thesismath{\@Oldxi}\xspace}%
\renewcommand{\pi}{\thesismath{\@Oldpi}\xspace}%
\renewcommand{\varpi}{\thesismath{\@Oldvarpi}\xspace}%
\renewcommand{\rho}{\thesismath{\@Oldrho}\xspace}%
\renewcommand{\varrho}{\thesismath{\@Oldvarrho}\xspace}%
\renewcommand{\sigma}{\thesismath{\@Oldsigma}\xspace}%
\renewcommand{\varsigma}{\thesismath{\@Oldvarsigma}\xspace}%
\renewcommand{\tau}{\thesismath{\@Oldtau}\xspace}%
\renewcommand{\upsilon}{\thesismath{\@Oldupsilon}\xspace}%
\renewcommand{\phi}{\thesismath{\@Oldphi}\xspace}%
\renewcommand{\varphi}{\thesismath{\@Oldvarphi}\xspace}%
\renewcommand{\chi}{\thesismath{\@Oldchi}\xspace}%
\renewcommand{\psi}{\thesismath{\@Oldpsi}\xspace}%
\renewcommand{\omega}{\thesismath{\@Oldomega}\xspace}%

%% Commands
\DeclareRobustCommand{\isabout}{\sim\,}
\DeclareRobustCommand{\isAbout}{\isabout}
\DeclareRobustCommand{\about}{\thesismath{\@oldsim\!\,}}
\DeclareRobustCommand{\goesto}{\thesismath{ \, \Rightarrow \, }}
\DeclareRobustCommand{\isdefined}{ \equiv }
\DeclareRobustCommand{\isdefinedas}{ \equiv }
%\DeclareRobustCommand{\expectation}[1]{\thesismath{ \mathcal{E}\lbrack#1\rbrack }}
\DeclareRobustCommand{\FT}[1]{\thesismath{ \mathcal{FT}\lbrack {#1} \rbrack }}
\DeclareRobustCommand{\LT}[1]{\thesismath{ \mathcal{LT}\lbrack {#1} \rbrack }}
\DeclareRobustCommand{\operand}{\thesismath{ \bullet }}
\DeclareRobustCommand{\scalesas}{\thesismath{ \propto }}
\DeclareRobustCommand{\powerten}[1]{\thesismath{ \power{10}{#1} }}


%% Parenthetic operations
\DeclareRobustCommand{\ofOrder}[1]{\thesismath{ \mathcal{O}\parenths{#1} }}
\DeclareRobustCommand{\orderof}[1]{ \ofOrder{#1} }
\DeclareRobustCommand{\isOfOrder}[1]{\thesismath{ \sim \ofOrder{#1} }}
\DeclareRobustCommand{\expectationOf}[1]{\thesismath{ \mathscr{E}\bracs{#1} }}
\DeclareRobustCommand{\DeltaOf}[1]{\thesismath{ \Delta\!\mspace{2.0mu}{#1} }}
\DeclareRobustCommand{\deltaOf}[1]{\thesismath{ \delta\!\mspace{2.0mu}{#1} }}
\DeclareRobustCommand{\argOf}[1]{\thesismath{ \arg\!\parenths{#1} }}
\DeclareRobustCommand{\sinOf}[1]{\thesismath{ \sin\!\parenths{#1} }}
\DeclareRobustCommand{\cosOf}[1]{\thesismath{ \cos\!\parenths{#1} }}
\DeclareRobustCommand{\tanOf}[1]{\thesismath{ \tan\!\parenths{#1} }}
\DeclareRobustCommand{\sinhOf}[1]{\thesismath{ \sinh\!\parenths{#1} }}
\DeclareRobustCommand{\coshOf}[1]{\thesismath{ \cosh\!\parenths{#1} }}
\DeclareRobustCommand{\tanhOf}[1]{\thesismath{ \tanh\!\parenths{#1} }}
\DeclareRobustCommand{\arcsinOf}[1]{\thesismath{ \arcsin\!\parenths{#1} }}
\DeclareRobustCommand{\arccosOf}[1]{\thesismath{ \arccos\!\parenths{#1} }}
\DeclareRobustCommand{\arctanOf}[1]{\thesismath{ \arctan\!\parenths{#1} }}
\DeclareRobustCommand{\arcsinhOf}[1]{\thesismath{ \arcsinh\!\parenths{#1} }}
\DeclareRobustCommand{\arccoshOf}[1]{\thesismath{ \arccosh\!\parenths{#1} }}
\DeclareRobustCommand{\arctanhOf}[1]{\thesismath{ \arctanh\!\parenths{#1} }}

%% Numbers
\DeclareRobustCommand{\nhalfs}[1]{\thesismath{\frac{#1}{2}\,}\xspace}
\DeclareRobustCommand{\nthirds}[1]{\thesismath{\frac{#1}{3}\,}\xspace}
\DeclareRobustCommand{\nquarters}[1]{\thesismath{\frac{#1}{4}\,}\xspace}
\DeclareRobustCommand{\half}{\nhalfs{1}\xspace}
\DeclareRobustCommand{\onethird}{\nthirds{1}\xspace}
\DeclareRobustCommand{\onequarter}{\nquarters{1}\xspace}
\DeclareRobustCommand{\oneover}[1]{\thesismath{\frac{1}{#1}}\xspace}
\DeclareRobustCommand{\I}{\thesismath{\imath}}
\let\@oldRe\Re
\let\@oldIm\Im
\DeclareRobustCommand{\Im}{\thesismath{ \@oldIm{}\mathfrak{m} }\xspace}
\DeclareRobustCommand{\Re}{\thesismath{ \@oldRe{}\mathfrak{e}\mspace{3mu} }\xspace}
\DeclareRobustCommand{\ImaginaryPart}[1]{\thesismath{ \,\Im\!\,\braces{#1} }\xspace}
\DeclareRobustCommand{\RealPart}[1]{\thesismath{ \,\Re\!\braces{#1} }\xspace}
\DeclareRobustCommand{\percent}{\%\xspace}

%% Groups
\DeclareRobustCommand{\group}[1]{\thesismath{\mayberm{#1}}}
\DeclareRobustCommand{\Ugroup}[1]{\group{U}\parenths{#1}}
\DeclareRobustCommand{\SUgroup}[1]{\group{S}\Ugroup{#1}}
\DeclareRobustCommand{\Ogroup}[1]{\group{O}\parenths{#1}}
\DeclareRobustCommand{\SOgroup}[1]{\group{S}\Ogroup{#1}}
\DeclareRobustCommand{\Egroup}[1]{\group{E}_{#1}}
\DeclareRobustCommand{\directsum}{\thesismath{\oplus}}
\DeclareRobustCommand{\directprod}{\thesismath{\otimes}}
\DeclareRobustCommand{\covers}{\thesismath{\supset}}
\DeclareRobustCommand{\exclude}{\thesismath{\backslash}}

%% Physics
\DeclareRobustCommand{\commutator}[2]{\sqbracs{{#1},{#2}}}
\DeclareRobustCommand{\anticommutator}[2]{\braces{{#1},{#2}}}

%% Tensors
\DeclareRobustCommand{\Kronecker}{\thesismath{\delta}\xspace} % have to specify indices separately now
\DeclareRobustCommand{\LeviCivita}{\thesismath{\epsilon}\xspace} % have to specify indices separately now

%% Vectors, tuples and sets
\DeclareRobustCommand{\cross}{\thesismath{\times}\xspace}
\DeclareRobustCommand{\bvec}[1]{\thesismath{\bm{#1}}\xspace}
\DeclareRobustCommand{\colset}[1]{\thesismath{\begin{Bmatrix}#1\end{Bmatrix}}\xspace}
\DeclareRobustCommand{\coltuple}[1]{\thesismath{\begin{pmatrix}#1\end{pmatrix}}\xspace}
\DeclareRobustCommand{\colvector}[1]{\thesismath{\begin{pmatrix}#1\end{pmatrix}}\xspace}
\DeclareRobustCommand{\colthreevec}[3]{\thesismath{\begin{pmatrix}#1\\ #2\\ #3\end{pmatrix}}\xspace}
\DeclareRobustCommand{\rowset}[1]{\braces{#1}\xspace}
\DeclareRobustCommand{\rowtuple}[1]{\parenths{#1}\xspace}
\DeclareRobustCommand{\rowvector}[1]{\parenths{#1}\xspace}
\DeclareRobustCommand{\rowthreevec}[3]{\parenths{{#1}, {#2}, {#3}}\xspace}

%% Ranges
\DeclareRobustCommand{\rangeSS}[1]{\parenths{#1}\xspace}
\DeclareRobustCommand{\rangeSH}[1]{\left({#1}\right]\xspace}
\DeclareRobustCommand{\rangeHS}[1]{\left[{#1}\right)\xspace}
\DeclareRobustCommand{\rangeHH}[1]{\sqbracs{#1}\xspace}
\DeclareRobustCommand{\softrange}[1]{\rangeSS{#1}}
\DeclareRobustCommand{\hardrange}[1]{\rangeHH{#1}}

%% Matrix
\DeclareRobustCommand{\boldmatrix}[1]{\thesismath{\bm{\mathrm{#1}}}\xspace}
\DeclareRobustCommand{\transposeT}{\MathUpright{T}\,}
\DeclareRobustCommand{\hermitianT}{\dagger}
\DeclareRobustCommand{\twomatrix}[2]{\thesismath{\begin{pmatrix}#1\\ #2\end{pmatrix}}\xspace}
\DeclareRobustCommand{\threematrix}[3]{\thesismath{\begin{pmatrix}#1\\ #2\\ #3\end{pmatrix}}\xspace}

%% Differentials
\DeclareRobustCommand{\diff}[1]{\thesismath{\mathrm{d} #1}}
\DeclareRobustCommand{\pdiff}[1]{\thesismath{\partial #1}}
\DeclareRobustCommand{\dByd}[2]{\thesismath{ \frac{\diff{#1}}{\diff{#2}} }}
\DeclareRobustCommand{\pdByd}[2]{\thesismath{ \frac{\pdiff{#1}}{\pdiff{#2}} }}
\DeclareRobustCommand{\DeltaVec}[1]{\thesismath{\boldsymbol{\Delta}\mathbf{#1}}}
\DeclareRobustCommand{\DeltaN}[1]{\thesismath{\Delta #1}}
\DeclareRobustCommand{\deltaVec}[1]{\thesismath{\boldsymbol{\delta}\mathbf{#1}}}
\DeclareRobustCommand{\deltaN}[1]{\thesismath{\delta #1}}
\DeclareRobustCommand{\d}[1]{\thesismath{\mathrm{d}#1}}
\DeclareMathOperator{\curl}{curl} % curl
%\DeclareMathOperator{\div}{div} % div
\DeclareRobustCommand{\gradCross}[1]{\thesismath{\nabla \cross #1}} % curl
\DeclareRobustCommand{\gradDot}[1]{\thesismath{\nabla \dot #1}} % div
\DeclareRobustCommand{\Laplacian}{\thesismath{\backslash}}
\DeclareRobustCommand{\dAlembertian}{\thesismath{\box^{2}}} % I like it with power of 2 attached :-)
\DeclareRobustCommand{\exclude}{\thesismath{\backslash}}


%% Statistics and probability
\DeclareRobustCommand{\mean}[1]{\angles{#1}}
\DeclareRobustCommand{\given}{\thesismath{\vert}}
\DeclareRobustCommand{\probabilityP}{\thesismath{\mayberm{p}}}
\DeclareRobustCommand{\probability}[1]{\thesismath{\probabilityP\parenths{#1}}}


%% Principle value integral signs (from UK TeX FAQ)
\def\Xint#1{\mathchoice
   {\XXint\displaystyle\textstyle{#1}}%
   {\XXint\textstyle\scriptstyle{#1}}%
   {\XXint\scriptstyle\scriptscriptstyle{#1}}%
   {\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
   \!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
     \vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}


% Fix hyperref labels in PDFTeX
\@ifpackageloaded{hyperref}{%
  \pdfstringdefDisableCommands{%
      \def\pi{pi}%
      \def\gamma{gamma}%
      \def\alpha{alpha}%
  }%
}{} 
